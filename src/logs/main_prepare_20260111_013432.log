

=== load_config ===
Loading configuration from: /volume/pt-train/users/wzhang/ghchen/zh/CoBench/config_B.yaml


=== prepare_scores ===
Getting scores for task: math
Small model output: results/Qwen3-8B/math.jsonl
Large model output: results/gpt-5/math.jsonl
Evaluating small model...
Evaluating weak model on math...
DEBUG: Model name/path: 
DEBUG: Has chat_template: False
Generated 5000 prompts

--- exception ---
Traceback (most recent call last):
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_transports/default.py", line 394, in handle_async_request
    resp = await self._pool.handle_async_request(req)
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpcore/_async/connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpcore/_async/connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    raise exc
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpcore/_async/connection.py", line 78, in handle_async_request
    stream = await self._connect(request)
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpcore/_async/connection.py", line 124, in _connect
    stream = await self._network_backend.connect_tcp(**kwargs)
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpcore/_backends/auto.py", line 31, in connect_tcp
    return await self._backend.connect_tcp(
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpcore/_backends/anyio.py", line 113, in connect_tcp
    with map_exceptions(exc_map):
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/volume/pt-train/users/wzhang/ghchen/zh/CoBench/src/main.py", line 43, in run
    return fn(*args, **kwargs)
  File "/volume/pt-train/users/wzhang/ghchen/zh/CoBench/src/pipeline.py", line 760, in get_task_score
    return pipeline.get_score(task, judge_model, question_file, ref_answer_file)
  File "/volume/pt-train/users/wzhang/ghchen/zh/CoBench/src/pipeline.py", line 174, in get_score
    small_result = self.data_manager.evaluator.evaluate_single_dataset(
  File "/volume/pt-train/users/wzhang/ghchen/zh/CoBench/src/data.py", line 232, in evaluate_single_dataset
    generated = self.evaluate_model(
  File "/volume/pt-train/users/wzhang/ghchen/zh/CoBench/src/data.py", line 111, in evaluate_model
    responses = parallel_inference(
  File "/volume/pt-train/users/wzhang/ghchen/zh/CoBench/src/inference/vllm_client.py", line 163, in parallel_inference
    return asyncio.run(distribute_requests(prompt_list,
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/volume/pt-train/users/wzhang/ghchen/zh/CoBench/src/inference/vllm_client.py", line 72, in distribute_requests
    results = await asyncio.gather(*tasks)
  File "/volume/pt-train/users/wzhang/ghchen/zh/CoBench/src/inference/vllm_client.py", line 83, in fetch_results
    response = await client.post(f"{server_url}/inference", json={
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_client.py", line 1859, in post
    return await self.request(
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/volume/pt-train/users/wzhang/ghchen/zh/miniconda3/envs/router/lib/python3.10/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed
Getting scores for task: math
Small model output: results/Qwen3-8B/math.jsonl
Large model output: results/gpt-5/math.jsonl
Evaluating small model...
Evaluating weak model on math...
DEBUG: Model name/path: 
DEBUG: Has chat_template: False
Generated 5000 prompts
